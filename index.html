<!DOCTYPE html>
<html>
<head>
 <title>Learnthings.js</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="data.js"></script>
<style type="text/css">
body {
  margin: 0;
  padding: 0;
  background: #000;
  overflow: hidden;
}
#theimage {
  width: 100%;
}
</style>
<script type="text/javascript">

// At least how many milliseconds each image is showed
var timeTreshold = 5000;
// How many times any key must be pressed after timeTreshold seconds
var keyTreshold = 5;


var changeImage = function() {
	$image = $("#theimage")
	var i = Math.floor(Math.random() * images.length);
	$("#main").css("margin-top", "-1100px");
	$image.attr("src", images[i]);

	$("#theaudio").attr("src", sounds[i]);
	// delay slide so that the images has been loaded
	setTimeout("slideImage()", 100);

	setTimeout("nextImage()", timeTreshold);
};

// wait for keyTreshold keypresses
var nextImage = function(keysLimit) {
	if (keysLimit == undefined) {
		setTimeout("nextImage(" + (keypressed + keyTreshold) + ")", 500);
	} else if (keypressed > keysLimit) {
		changeImage();
	} else {
		setTimeout("nextImage(" + keysLimit + ")", 500);
	}
};

var slideImage = function() {
    $('#main').animate({
        "margin-top": "0"
    }, 'slow', function() {
        // Animation complete.
	$("#theaudio")[0].play();
    });
}

var keypressed = 0;
var oldKey = 0;

$(document).ready(function(){
	// keydown event loop
	$("body").keydown(function(event) {
		if (event.keyCode != oldKey) {
			keypressed++;
		}
		oldKey = event.keyCode;
	});

	changeImage();
});

</script>
</head>
<body>


<div id="main"><img id="theimage"></div>
<audio id="theaudio">
</audio>

</body>
</html>
